var WPDashboardTwitter = {		init: function() {		this.onLoad();	},		onLoad: function() {		jQuery("#wpdt-tabs").tabs({			active: wpdtAjaxL10n.startupTab,			activate: WPDashboardTwitter.onActivate		});				jQuery('#wpdt-btn-load-replies').on('click', function() {			WPDashboardTwitter.tabLoader( 0 );			return false;		});		jQuery('#wpdt-btn-load-favorites').on('click', function() {			WPDashboardTwitter.tabLoader( 1 );			return false;		});		jQuery('#wpdt-btn-load-retweets').on('click', function() {			WPDashboardTwitter.tabLoader( 2 );			return false;		});		jQuery('#wpdt-btn-load-timeline').on('click', function() {			WPDashboardTwitter.tabLoader( 3 );			return false;		});				WPDashboardTwitter.tabLoader( wpdtAjaxL10n.startupTab );				jQuery('.wpdt-btn-update-status').on('click', function() {			WPDashboardTwitter.showWritePanel();			return false;		});				jQuery('#wpdt-btn-cancel-status-update').on('click', function() {			WPDashboardTwitter.hideWritePanel();			return false;		});				jQuery('#wpdt-btn-send-status-update').on('click', function() {			var tweettxt = jQuery('#wpdt-txtarea').val();			var length = jQuery('#wpdt-txtarea').val().length;			if( length == 0 || jQuery.trim(tweettxt) == '' ) {				alert( wpdtAjaxL10n.emptyTweetMsg );			} else {				var revert_t = jQuery('#wpdt-btn-send-status-update').text();				jQuery('#wpdt-btn-send-status-update').text( wpdtAjaxL10n.sendingTweetMsg );				WPDashboardTwitter.send_update( revert_t );			}			return false;		});				jQuery('#wpdt-btn-shorten-url').on('click', function() {			var longurl = jQuery('#wpdt-long-url').val();			var length = jQuery('#wpdt-long-url').val().length;			if( length == 0 || jQuery.trim(longurl) == '' ) {				alert( wpdtAjaxL10n.emptyLongUrlMsg );			} else {				WPDashboardTwitter.shorten_url( longurl );			}			return false;		});				jQuery("#wpdt-txtarea").bind("keyup focus", function() {  			var expr = /^d[\s](.*)[\s].*/i; 			var tweettext = jQuery(this).val();			var result = expr.test( tweettext );			if (result == false) {				jQuery('#wpdt-btn-send-status-update').text( wpdtAjaxL10n.updateStatusMsg );			} else {				jQuery('#wpdt-btn-send-status-update').text( wpdtAjaxL10n.sendDMMsg );			}		});	},		onActivate: function( e, tab ) {		WPDashboardTwitter.tabLoader( tab.newTab.index() );	},		tabLoader: function( index ) {		switch ( index ) {			case 0:				WPDashboardTwitter.load_replies();				break;			case 1:				WPDashboardTwitter.load_favorites();				break;			case 2:				WPDashboardTwitter.load_retweets();				break;			case 3:				WPDashboardTwitter.load_timeline();				break;		}	},		showWritePanel: function() {		jQuery.getScript(wpdtAjaxL10n.uploadFileURI + "js/charcounter.js");				var isHidden = jQuery('#wpdt-update-wrapper').is(':hidden');		if( isHidden ) {			jQuery("#wpdt-tabs").tabs('option', 'disabled', [0,1,2,3,4,5]);			jQuery('.wpdt-btn-update-status').fadeOut();			jQuery('#wpdt-update-wrapper').slideDown();		}	},		hideWritePanel: function() {		var isVisible = jQuery('#wpdt-update-wrapper').is(':visible');		if( isVisible ) {			jQuery("#wpdt-tabs").tabs('option', 'disabled', []);			jQuery('.wpdt-btn-update-status').fadeIn();			jQuery('#wpdt-update-wrapper').slideUp();		}		jQuery('#wpdt-btn-send-status-update').text( wpdtAjaxL10n.updateStatusMsg );		jQuery('#wpdt-txtarea').val('');		jQuery('#wpdt_in_reply_to_statusid').val('');		jQuery('#wpdt-long-url').val('');	},		reply: function( self, type, replytoid ) {		jQuery("#wpdt-tabs").tabs('option', 'disabled', [0,1,2,3]);		jQuery('.wpdt-btn-update-status').hide();		jQuery('#wpdt-update-wrapper').show();		jQuery.getScript(wpdtAjaxL10n.uploadFileURI + "js/charcounter.js");		if( type == 0 ) {			jQuery('#wpdt_in_reply_to_statusid').val( replytoid );			var replytoname = jQuery( self ).attr('replytoname');			jQuery('#wpdt-txtarea').val('@' + replytoname + ' ');		} else if( type == 1 ) {			var replytoname = jQuery( self ).attr('replytoname');			jQuery('#wpdt-txtarea').val('d ' + replytoname + ' ');		} else if( type == 2 ) {			var tweetxt = jQuery( self ).parent().next().find('p').html();			tweetxt = tweetxt.replace(/(<([^>]+)>)/gi, "");			var replytoname = jQuery( self ).prev().attr('replytoname');			jQuery('#wpdt-txtarea').val('RT @' + replytoname + ' ' + tweetxt);			jQuery('#wpdt_in_reply_to_statusid').val('');		}		jQuery('#wpdt-txtarea').focus();		return false;	},		load_replies: function() {		var wpdt_sack = new sack(wpdtAjaxL10n.requestUrl);		wpdt_sack.execute = 1;		wpdt_sack.method = 'POST';		wpdt_sack.setVar( "action", "wpdt_load_replies" );		wpdt_sack.setVar( "ajaxCall", 1 );		wpdt_sack.setVar( "_ajax_nonce", wpdtAjaxL10n._ajax_nonce );		wpdt_sack.onLoading = function() { jQuery('.wpdt-ajax-loader').show(); };		wpdt_sack.onCompletion = function() { jQuery('.wpdt-ajax-loader').hide(); };		//wpdt_sack.onError = function() { alert('AJAX error while loading replies.') };		wpdt_sack.runAJAX();	},		load_direct_messages: function() {		var wpdt_sack = new sack(wpdtAjaxL10n.requestUrl);		wpdt_sack.execute = 1;		wpdt_sack.method = 'POST';		wpdt_sack.setVar( "action", "wpdt_load_direct_messages" );		wpdt_sack.setVar( "ajaxCall", 1 );		wpdt_sack.setVar( "_ajax_nonce", wpdtAjaxL10n._ajax_nonce );		wpdt_sack.onLoading = function() { jQuery('.wpdt-ajax-loader').show(); };		wpdt_sack.onCompletion = function() { jQuery('.wpdt-ajax-loader').hide(); };		//wpdt_sack.onError = function() { alert('AJAX error while loading direct messages.') };		wpdt_sack.runAJAX();	},		load_sent_messages: function() {		var wpdt_sack = new sack(wpdtAjaxL10n.requestUrl);		wpdt_sack.execute = 1;		wpdt_sack.method = 'POST';		wpdt_sack.setVar( "action", "wpdt_load_sent_messages" );		wpdt_sack.setVar( "ajaxCall", 1 );		wpdt_sack.setVar( "_ajax_nonce", wpdtAjaxL10n._ajax_nonce );		wpdt_sack.onLoading = function() { jQuery('.wpdt-ajax-loader').show(); };		wpdt_sack.onCompletion = function() { jQuery('.wpdt-ajax-loader').hide(); };		//wpdt_sack.onError = function() { alert('AJAX error while loading sent messages.') };		wpdt_sack.runAJAX();	},		load_favorites: function() {		var wpdt_sack = new sack(wpdtAjaxL10n.requestUrl);		wpdt_sack.execute = 1;		wpdt_sack.method = 'POST';		wpdt_sack.setVar( "action", "wpdt_load_favorites" );		wpdt_sack.setVar( "ajaxCall", 1 );		wpdt_sack.setVar( "_ajax_nonce", wpdtAjaxL10n._ajax_nonce );		wpdt_sack.onLoading = function() { jQuery('.wpdt-ajax-loader').show(); };		wpdt_sack.onCompletion = function() { jQuery('.wpdt-ajax-loader').hide(); };		//wpdt_sack.onError = function() { alert('AJAX error while loading favorites.') };		wpdt_sack.runAJAX();	},		load_retweets: function() {		var wpdt_sack = new sack(wpdtAjaxL10n.requestUrl);		wpdt_sack.execute = 1;		wpdt_sack.method = 'POST';		wpdt_sack.setVar( "action", "wpdt_load_retweets" );		wpdt_sack.setVar( "ajaxCall", 1 );		wpdt_sack.setVar( "_ajax_nonce", wpdtAjaxL10n._ajax_nonce );		wpdt_sack.onLoading = function() { jQuery('.wpdt-ajax-loader').show(); };		wpdt_sack.onCompletion = function() { jQuery('.wpdt-ajax-loader').hide(); };		//wpdt_sack.onError = function() { alert('AJAX error while loading retweets.') };		wpdt_sack.runAJAX();	},		load_timeline: function() {		var wpdt_sack = new sack(wpdtAjaxL10n.requestUrl);		wpdt_sack.execute = 1;		wpdt_sack.method = 'POST';		wpdt_sack.setVar( "action", "wpdt_load_timeline" );		wpdt_sack.setVar( "ajaxCall", 1 );		wpdt_sack.setVar( "_ajax_nonce", wpdtAjaxL10n._ajax_nonce );		wpdt_sack.onLoading = function() { jQuery('.wpdt-ajax-loader').show(); };		wpdt_sack.onCompletion = function() { jQuery('.wpdt-ajax-loader').hide(); };		//wpdt_sack.onError = function() { alert('AJAX error while loading timeline.') };		wpdt_sack.runAJAX();	},		send_update: function( revert_t ) {		var status_text = jQuery('#wpdt-txtarea').val();		var in_reply_to_statusid = jQuery('#wpdt_in_reply_to_statusid').val();		var wpdt_sack = new sack(wpdtAjaxL10n.requestUrl);		wpdt_sack.execute = 1;		wpdt_sack.method = 'POST';		wpdt_sack.setVar( "action", "wpdt_send_update" );		wpdt_sack.setVar( "status_text", status_text );		wpdt_sack.setVar( "in_reply_to_statusid", in_reply_to_statusid );		wpdt_sack.setVar( "ajaxCall", 1 );		wpdt_sack.setVar( "_ajax_nonce", wpdtAjaxL10n._ajax_nonce );		wpdt_sack.onLoading = function() { jQuery('#wpdt-ajax-loader-update').show(); };		wpdt_sack.onCompletion = function() { jQuery('#wpdt-ajax-loader-update').hide(); jQuery('#wpdt-btn-send-status-update').text( revert_t ); WPDashboardTwitter.hideWritePanel(); };		//wpdt_sack.onError = function() { alert('AJAX error while sending tweet.') };		wpdt_sack.runAJAX();	},		shorten_url: function( longurl ) {		var wpdt_sack = new sack(wpdtAjaxL10n.requestUrl);		wpdt_sack.execute = 1;		wpdt_sack.method = 'POST';		wpdt_sack.setVar( "action", "wpdt_shorten_url" );		wpdt_sack.setVar( "longurl", longurl );		wpdt_sack.setVar( "ajaxCall", 1 );		wpdt_sack.setVar( "_ajax_nonce", wpdtAjaxL10n._ajax_nonce );		wpdt_sack.onLoading = function() { jQuery('#wpdt-ajax-loader-update').show(); };		wpdt_sack.onCompletion = function(d) { jQuery('#wpdt-ajax-loader-update').hide(); jQuery('#wpdt-long-url').val(''); };		//wpdt_sack.onError = function() { alert('AJAX error while shortening URI.') };		wpdt_sack.runAJAX();	},		shorten_imgurl: function( imgbasename ) {		var wpdt_sack = new sack(wpdtAjaxL10n.requestUrl);		wpdt_sack.execute = 1;		wpdt_sack.method = 'POST';		wpdt_sack.setVar( "action", "wpdt_shorten_imgurl" );		wpdt_sack.setVar( "imgbasename", imgbasename );		wpdt_sack.setVar( "ajaxCall", 1 );		wpdt_sack.setVar( "_ajax_nonce", wpdtAjaxL10n._ajax_nonce );		wpdt_sack.onLoading = function() { jQuery('#wpdt-ajax-loader-update').show(); };		wpdt_sack.onCompletion = function(d) { jQuery('#wpdt-ajax-loader-update').hide(); };		//wpdt_sack.onError = function() { alert('Ajax error') };		wpdt_sack.runAJAX();	}}jQuery(document).ready(function(jQuery) {	WPDashboardTwitter.init();});